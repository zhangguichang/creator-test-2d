{"version":3,"sources":["assets/Script/joystick/JoyStick.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class JoyStick extends cc.Component {\n\n    @property({ type: cc.Node, displayName: \"摇杆节点\" })\n    joyStickNode: cc.Node = null;\n    @property({ type: cc.Node, displayName: \"杆节点\" })\n    stick: cc.Node = null;\n\n    @property(cc.Node)\n    testNode: cc.Node = null;\n\n    // 半径\n    private _r: number = 0;\n    onLoad() {\n        this.addEventListener();\n        this._r = this.joyStickNode.width / 2 - 50;\n    }\n    start() {\n    }\n\n    addEventListener() {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\n    }\n    onTouchStart(event: cc.Touch) {\n        let touchPos = this.node.convertToNodeSpaceAR<cc.Vec3>(cc.v3(event.getLocation()));\n        this.joyStickNode.position = touchPos;\n    }\n    onTouchMove(event: cc.Touch) {\n        let touchPos = this.joyStickNode.convertToNodeSpaceAR<cc.Vec3>(cc.v3(event.getLocation()));\n        let distance = touchPos.mag();\n        let p = touchPos.normalize();\n        if (distance <= this._r) {\n            this.stick.position = touchPos;\n        } else {\n            let ratio = this._r / distance;\n            let pos = cc.v3(0, 0).lerp(touchPos, ratio);\n            this.stick.position = pos;\n        }\n        \n        p.mulSelf(cc.director.getDeltaTime() * 100);\n        console.log(p);\n        this.testNode.position = this.testNode.position.add(p)\n    }\n    onTouchEnd(event: cc.Touch) {\n        this.stick.position = cc.v3(0, 0);\n    }\n\n    setRo(pos: cc.Vec3) {\n        let touq = this.node.convertToNodeSpaceAR<cc.Vec3>(cc.v3(pos));\n        console.log(touq);\n        let subPos = touq.sub(this.testNode.position);\n        let p = cc.v2(0, 1).signAngle(cc.v2(subPos));\n        let angle = cc.misc.radiansToDegrees(p);\n        this.testNode.angle = angle;\n    }\n    // update (dt) {}\n}\n"]}